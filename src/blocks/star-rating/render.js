// Import block dependencies and components.
import classnames from 'classnames';
import { __ } from '@wordpress/i18n';
import { RichText } from '@wordpress/block-editor';
import styles from './editor.lazy.scss';
import React, { useLayoutEffect } from 'react';
import { useDeviceType } from '@Controls/getPreviewType';

const Render = ( props ) => {
	// Add and remove the CSS on the drop and remove of the component.
	useLayoutEffect( () => {
		styles.use();
		return () => {
			styles.unuse();
		};
	}, [] );

	props = props.parentProps;
	const deviceType = useDeviceType();
	// Setup the attributes
	const {
		className,
		setAttributes,
		attributes: { isPreview, rating, range, title },
	} = props;

	const rangeValue = parseInt( range );
	const stars = [];
	for ( let i = 1; i <= rangeValue; i++ ) {
		stars.push(
			<span key={ i } className="uag-star">
				â˜…
			</span>
		);
	}
	const previewImageData = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNi4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iMzUwcHgiIGhlaWdodD0iMzUwcHgiIHZpZXdCb3g9IjAgMCAzNTAgMzUwIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAzNTAgMzUwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxwYXRoIGZpbGw9IiNEQkRDREUiIGQ9Ik0xNjIuMjkyLDEyOC41MTZjMCw0LjI2NS0zLjQ1OCw3LjcyMi03LjcyMSw3LjcyMkgzNi44MWMtNC4yNjUsMC03LjcyMi0zLjQ1OC03LjcyMi03LjcyMnYwLjQ2OA0KCWMwLTQuMjY0LDMuNDU3LTcuNzIyLDcuNzIyLTcuNzIyaDExNy43NjJjNC4yNjQsMCw3LjcyMSwzLjQ1OCw3LjcyMSw3LjcyMlYxMjguNTE2eiIvPg0KPGc+DQoJPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiNEQkRDREUiIGQ9Ik0yMzIuOTM3LDExOC45NGMwLjM4Mi0wLjAwMiwwLjYwNCwwLjE1NywwLjc1MywwLjQ2Mg0KCQljMC44NzksMS43OTMsMS43NjgsMy41ODIsMi42NDYsNS4zNzNjMC4wNjMsMC4xMjcsMC4xMjksMC4xOSwwLjI4LDAuMjExYzEuOTYyLDAuMjc3LDMuOTI0LDAuNTY3LDUuODg3LDAuODUxDQoJCWMwLjU0NiwwLjA3OSwwLjg0MiwwLjM4LDAuNzY0LDAuODM0Yy0wLjAzMiwwLjE3OC0wLjE0NiwwLjM2Ny0wLjI3OCwwLjQ5NmMtMS40MjQsMS40MDYtMi44NTYsMi43OTktNC4yOSw0LjE5Mg0KCQljLTAuMTAyLDAuMDk4LTAuMTM5LDAuMTgzLTAuMTEzLDAuMzMzYzAuMzQ3LDEuOTksMC42ODQsMy45ODEsMS4wMjUsNS45NzJjMC4wNTUsMC4zMTMtMC4wMjYsMC41NzItMC4yODUsMC43NTcNCgkJYy0wLjI1OCwwLjE4Ny0wLjUzMSwwLjE3NC0wLjgwOSwwLjAyOGMtMS43NzItMC45MzQtMy41NS0xLjg2My01LjMyMS0yLjgwMmMtMC4xNTMtMC4wODItMC4yNjItMC4wNzYtMC40MTQsMC4wMDMNCgkJYy0xLjc1NywwLjkzMS0zLjUyNSwxLjg0NS01LjI3OCwyLjc4NGMtMC41NDgsMC4yOTQtMS4xLTAuMDIyLTEuMTQ2LTAuNTI5Yy0wLjAxLTAuMTE3LDAuMDEtMC4yNCwwLjAyOC0wLjM1Nw0KCQljMC4zMzUtMS45NTQsMC42NjctMy45MDksMS4wMTItNS44NmMwLjAyNi0wLjE1Mi0wLjAxNi0wLjIzNS0wLjExNS0wLjMzMmMtMS40MzUtMS4zOTQtMi44NjgtMi43ODctNC4yOTMtNC4xOTENCgkJYy0wLjEyNi0wLjEyNS0wLjIzNi0wLjMwMy0wLjI3My0wLjQ3NWMtMC4wODUtMC40MDMsMC4xNzMtMC43NSwwLjU4OC0wLjgxOGMwLjc5Ny0wLjEyNywxLjU5Ni0wLjIzOSwyLjM5NC0wLjM1NQ0KCQljMS4yMDktMC4xNzYsMi40MTgtMC4zNTQsMy42MjUtMC41MjJjMC4xNy0wLjAyMywwLjI2LTAuMDg4LDAuMzM0LTAuMjQyYzAuODc0LTEuNzg3LDEuNzU5LTMuNTY5LDIuNjM3LTUuMzU1DQoJCUMyMzIuNDM3LDExOS4xMDQsMjMyLjY1MiwxMTguOTQ1LDIzMi45MzcsMTE4Ljk0eiIvPg0KPC9nPg0KPGc+DQoJPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiNEQkRDREUiIGQ9Ik0yNTQuMzQ1LDExOC45NGMwLjM4My0wLjAwMiwwLjYwNCwwLjE1NywwLjc1NCwwLjQ2Mg0KCQljMC44NzgsMS43OTMsMS43NjcsMy41ODIsMi42NDYsNS4zNzNjMC4wNjMsMC4xMjcsMC4xMzEsMC4xOSwwLjI4LDAuMjExYzEuOTY0LDAuMjc3LDMuOTI1LDAuNTY3LDUuODg3LDAuODUxDQoJCWMwLjU0NiwwLjA3OSwwLjg0NCwwLjM4LDAuNzY0LDAuODM0Yy0wLjAzMywwLjE3OC0wLjE0NiwwLjM2Ny0wLjI3NywwLjQ5NmMtMS40MjUsMS40MDYtMi44NTYsMi43OTktNC4yOSw0LjE5Mg0KCQljLTAuMSwwLjA5OC0wLjEzOSwwLjE4My0wLjExNCwwLjMzM2MwLjM0OCwxLjk5LDAuNjg1LDMuOTgxLDEuMDI1LDUuOTcyYzAuMDU2LDAuMzEzLTAuMDI2LDAuNTcyLTAuMjg0LDAuNzU3DQoJCWMtMC4yNiwwLjE4Ny0wLjUzMiwwLjE3NC0wLjgwOSwwLjAyOGMtMS43NzQtMC45MzQtMy41NTEtMS44NjMtNS4zMjEtMi44MDJjLTAuMTUzLTAuMDgyLTAuMjYzLTAuMDc2LTAuNDE1LDAuMDAzDQoJCWMtMS43NTcsMC45MzEtMy41MjQsMS44NDUtNS4yNzYsMi43ODRjLTAuNTUsMC4yOTQtMS4xMDMtMC4wMjItMS4xNDctMC41MjljLTAuMDExLTAuMTE3LDAuMDEtMC4yNCwwLjAyOC0wLjM1Nw0KCQljMC4zMzUtMS45NTQsMC42NjktMy45MDksMS4wMTEtNS44NmMwLjAyNS0wLjE1Mi0wLjAxNS0wLjIzNS0wLjExNS0wLjMzMmMtMS40MzYtMS4zOTQtMi44NjgtMi43ODctNC4yOTItNC4xOTENCgkJYy0wLjEyNi0wLjEyNS0wLjIzOC0wLjMwMy0wLjI3My0wLjQ3NWMtMC4wODQtMC40MDMsMC4xNzItMC43NSwwLjU4OC0wLjgxOGMwLjc5Ny0wLjEyNywxLjU5NC0wLjIzOSwyLjM5NC0wLjM1NQ0KCQljMS4yMS0wLjE3NiwyLjQxNy0wLjM1NCwzLjYyNy0wLjUyMmMwLjE2OC0wLjAyMywwLjI1Ny0wLjA4OCwwLjMzMS0wLjI0MmMwLjg3NS0xLjc4NywxLjc2MS0zLjU2OSwyLjYzOC01LjM1NQ0KCQlDMjUzLjg0NSwxMTkuMTA0LDI1NC4wNjIsMTE4Ljk0NSwyNTQuMzQ1LDExOC45NHoiLz4NCjwvZz4NCjxnPg0KCTxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBmaWxsPSIjREJEQ0RFIiBkPSJNMjc1Ljc1MywxMTguOTRjMC4zODQtMC4wMDIsMC42MDQsMC4xNTcsMC43NTIsMC40NjINCgkJYzAuODgxLDEuNzkzLDEuNzY5LDMuNTgyLDIuNjQ4LDUuMzczYzAuMDYxLDAuMTI3LDAuMTMxLDAuMTksMC4yNzksMC4yMTFjMS45NjQsMC4yNzcsMy45MjYsMC41NjcsNS44ODcsMC44NTENCgkJYzAuNTQ2LDAuMDc5LDAuODQ0LDAuMzgsMC43NjMsMC44MzRjLTAuMDMxLDAuMTc4LTAuMTQ2LDAuMzY3LTAuMjc1LDAuNDk2Yy0xLjQyNCwxLjQwNi0yLjg1NiwyLjc5OS00LjI5LDQuMTkyDQoJCWMtMC4xMDMsMC4wOTgtMC4xNDIsMC4xODMtMC4xMTMsMC4zMzNjMC4zNDcsMS45OSwwLjY4MywzLjk4MSwxLjAyNCw1Ljk3MmMwLjA1NiwwLjMxMy0wLjAyNiwwLjU3Mi0wLjI4NiwwLjc1Nw0KCQljLTAuMjU3LDAuMTg3LTAuNTI5LDAuMTc0LTAuODA5LDAuMDI4Yy0xLjc3My0wLjkzNC0zLjU0OS0xLjg2My01LjMyLTIuODAyYy0wLjE1NC0wLjA4Mi0wLjI2Mi0wLjA3Ni0wLjQxMywwLjAwMw0KCQljLTEuNzU4LDAuOTMxLTMuNTI2LDEuODQ1LTUuMjc5LDIuNzg0Yy0wLjU0OSwwLjI5NC0xLjEtMC4wMjItMS4xNDctMC41MjljLTAuMDEtMC4xMTcsMC4wMS0wLjI0LDAuMDI5LTAuMzU3DQoJCWMwLjMzNC0xLjk1NCwwLjY2OS0zLjkwOSwxLjAxMS01Ljg2YzAuMDI2LTAuMTUyLTAuMDE2LTAuMjM1LTAuMTE1LTAuMzMyYy0xLjQzNS0xLjM5NC0yLjg2OC0yLjc4Ny00LjI5Mi00LjE5MQ0KCQljLTAuMTI4LTAuMTI1LTAuMjM3LTAuMzAzLTAuMjcyLTAuNDc1Yy0wLjA4NS0wLjQwMywwLjE3My0wLjc1LDAuNTg3LTAuODE4YzAuNzk1LTAuMTI3LDEuNTk2LTAuMjM5LDIuMzk0LTAuMzU1DQoJCWMxLjIxLTAuMTc2LDIuNDE3LTAuMzU0LDMuNjI1LTAuNTIyYzAuMTcxLTAuMDIzLDAuMjU4LTAuMDg4LDAuMzM0LTAuMjQyYzAuODc0LTEuNzg3LDEuNzYtMy41NjksMi42MzctNS4zNTUNCgkJQzI3NS4yNTQsMTE5LjEwNCwyNzUuNDcsMTE4Ljk0NSwyNzUuNzUzLDExOC45NHoiLz4NCjwvZz4NCjxnPg0KCTxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBmaWxsPSIjREJEQ0RFIiBkPSJNMjk3LjE2MiwxMTguOTRjMC4zODItMC4wMDIsMC42MDQsMC4xNTcsMC43NTQsMC40NjINCgkJYzAuODc5LDEuNzkzLDEuNzY4LDMuNTgyLDIuNjQ2LDUuMzczYzAuMDYzLDAuMTI3LDAuMTMsMC4xOSwwLjI4MSwwLjIxMWMxLjk2MiwwLjI3NywzLjkyNCwwLjU2Nyw1Ljg4NiwwLjg1MQ0KCQljMC41NDYsMC4wNzksMC44NDUsMC4zOCwwLjc2NSwwLjgzNGMtMC4wMzIsMC4xNzgtMC4xNDYsMC4zNjctMC4yNzcsMC40OTZjLTEuNDI2LDEuNDA2LTIuODU2LDIuNzk5LTQuMjkyLDQuMTkyDQoJCWMtMC4xMDEsMC4wOTgtMC4xMzgsMC4xODMtMC4xMTMsMC4zMzNjMC4zNDcsMS45OSwwLjY4NSwzLjk4MSwxLjAyNiw1Ljk3MmMwLjA1NCwwLjMxMy0wLjAyOCwwLjU3Mi0wLjI4NSwwLjc1Nw0KCQljLTAuMjU4LDAuMTg3LTAuNTMyLDAuMTc0LTAuODEsMC4wMjhjLTEuNzcyLTAuOTM0LTMuNTQ4LTEuODYzLTUuMzE5LTIuODAyYy0wLjE1NC0wLjA4Mi0wLjI2NS0wLjA3Ni0wLjQxNCwwLjAwMw0KCQljLTEuNzU4LDAuOTMxLTMuNTI2LDEuODQ1LTUuMjc5LDIuNzg0Yy0wLjU0OCwwLjI5NC0xLjEwMS0wLjAyMi0xLjE0OC0wLjUyOWMtMC4wMDgtMC4xMTcsMC4wMTEtMC4yNCwwLjAyOS0wLjM1Nw0KCQljMC4zMzUtMS45NTQsMC42NjgtMy45MDksMS4wMTMtNS44NmMwLjAyNi0wLjE1Mi0wLjAxNy0wLjIzNS0wLjExNi0wLjMzMmMtMS40MzQtMS4zOTQtMi44NjctMi43ODctNC4yOTEtNC4xOTENCgkJYy0wLjEyOC0wLjEyNS0wLjIzOC0wLjMwMy0wLjI3NS0wLjQ3NWMtMC4wODMtMC40MDMsMC4xNzMtMC43NSwwLjU5LTAuODE4YzAuNzk2LTAuMTI3LDEuNTk0LTAuMjM5LDIuMzkyLTAuMzU1DQoJCWMxLjIxLTAuMTc2LDIuNDE4LTAuMzU0LDMuNjI3LTAuNTIyYzAuMTY5LTAuMDIzLDAuMjU4LTAuMDg4LDAuMzMzLTAuMjQyYzAuODc1LTEuNzg3LDEuNzYtMy41NjksMi42MzctNS4zNTUNCgkJQzI5Ni42NjIsMTE5LjEwNCwyOTYuODc5LDExOC45NDUsMjk3LjE2MiwxMTguOTR6Ii8+DQo8L2c+DQo8Zz4NCgk8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iI0YxRjFGMiIgZD0iTTMxOC41NzEsMTE4Ljk0YzAuMzgzLTAuMDAyLDAuNjA0LDAuMTU3LDAuNzUyLDAuNDYyDQoJCWMwLjg4LDEuNzkzLDEuNzY4LDMuNTgyLDIuNjQ3LDUuMzczYzAuMDYzLDAuMTI3LDAuMTMxLDAuMTksMC4yOCwwLjIxMWMxLjk2MywwLjI3NywzLjkyNCwwLjU2Nyw1Ljg4NywwLjg1MQ0KCQljMC41NDYsMC4wNzksMC44NDIsMC4zOCwwLjc2MiwwLjgzNGMtMC4wMywwLjE3OC0wLjE0NSwwLjM2Ny0wLjI3NiwwLjQ5NmMtMS40MjQsMS40MDYtMi44NTYsMi43OTktNC4yOSw0LjE5Mg0KCQljLTAuMTAyLDAuMDk4LTAuMTM4LDAuMTgzLTAuMTEzLDAuMzMzYzAuMzQ3LDEuOTksMC42ODUsMy45ODEsMS4wMjUsNS45NzJjMC4wNTYsMC4zMTMtMC4wMjYsMC41NzItMC4yODQsMC43NTcNCgkJYy0wLjI1OSwwLjE4Ny0wLjUzMiwwLjE3NC0wLjgwOSwwLjAyOGMtMS43NzUtMC45MzQtMy41NTEtMS44NjMtNS4zMjItMi44MDJjLTAuMTUyLTAuMDgyLTAuMjYyLTAuMDc2LTAuNDE0LDAuMDAzDQoJCWMtMS43NTgsMC45MzEtMy41MjQsMS44NDUtNS4yNzYsMi43ODRjLTAuNTUxLDAuMjk0LTEuMTAzLTAuMDIyLTEuMTQ5LTAuNTI5Yy0wLjAwOS0wLjExNywwLjAxMS0wLjI0LDAuMDMtMC4zNTcNCgkJYzAuMzM1LTEuOTU0LDAuNjY3LTMuOTA5LDEuMDEtNS44NmMwLjAyNy0wLjE1Mi0wLjAxNS0wLjIzNS0wLjExNS0wLjMzMmMtMS40MzQtMS4zOTQtMi44NjctMi43ODctNC4yOTItNC4xOTENCgkJYy0wLjEyNS0wLjEyNS0wLjIzNy0wLjMwMy0wLjI3Mi0wLjQ3NWMtMC4wODUtMC40MDMsMC4xNzItMC43NSwwLjU4Ny0wLjgxOGMwLjc5NS0wLjEyNywxLjU5NS0wLjIzOSwyLjM5NC0wLjM1NQ0KCQljMS4yMDktMC4xNzYsMi40MTgtMC4zNTQsMy42MjQtMC41MjJjMC4xNzItMC4wMjMsMC4yNi0wLjA4OCwwLjMzNS0wLjI0MmMwLjg3NC0xLjc4NywxLjc2LTMuNTY5LDIuNjM2LTUuMzU1DQoJCUMzMTguMDcxLDExOS4xMDQsMzE4LjI4NywxMTguOTQ1LDMxOC41NzEsMTE4Ljk0eiIvPg0KPC9nPg0KPC9zdmc+DQo=';
	return (
		isPreview ? <img width='100%' src={previewImageData}/> :
		<div
			className={ classnames(
				className,
				`uagb-editor-preview-mode-${ deviceType.toLowerCase() }`,
				`uagb-block-${ props.clientId.substr( 0, 8 ) }`
			) }
		>
			<RichText
				tagName="p"
				placeholder={ __(
					'Write a title',
					'ultimate-addons-for-gutenberg'
				) }
				value={ title }
				className="uag-star-rating__title"
				onChange={ ( value ) => setAttributes( { title: value } ) }
			/>
			<div className="uag-star-rating" title={ `${ rating }/${ range }` }>
				{ stars }
			</div>
		</div>
	);
};
export default React.memo( Render );
