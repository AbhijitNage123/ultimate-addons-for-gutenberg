(window.webpackJsonp_ultimate_addons_for_gutenberg=window.webpackJsonp_ultimate_addons_for_gutenberg||[]).push([[67],{317:function(e,t,a){"use strict";var i=a(14),n=a.n(i)()((function(e){return e[1]}));n.push([e.i,".uagb-inspector-tab .block-editor-image-size-control .block-editor-image-size-control__row {\n  text-transform: capitalize; }\n\n.uagb-inspector-tab .components-base-control label.components-input-control__label {\n  text-transform: capitalize; }\n\n.uagb-inspector-tab .block-editor-image-size-control__row .components-button-group .components-button {\n  border: 1px solid #8f9395;\n  box-shadow: none;\n  font-size: 13px;\n  font-weight: 400;\n  height: 26px; }\n  .uagb-inspector-tab .block-editor-image-size-control__row .components-button-group .components-button.is-pressed {\n    background: #0085ba;\n    border-color: #0085ba; }\n\n.wp-block-uagb-image .components-resizable-box__container {\n  max-width: 100% !important;\n  height: auto !important; }\n  .wp-block-uagb-image .components-resizable-box__container img {\n    max-width: 100% !important; }\n\n.wp-block-uagb-image .components-placeholder.is-medium .components-placeholder__instructions {\n  display: block !important; }\n\n.wp-block-uagb-image .components-placeholder.is-medium .components-placeholder__fieldset {\n  flex-direction: row; }\n  .wp-block-uagb-image .components-placeholder.is-medium .components-placeholder__fieldset .components-button {\n    margin-right: 10px; }\n",""]),t.a=n},506:function(e,t,a){"use strict";a.r(t);var i=a(0),n=a.n(i),l=a(3),o=a.n(l),r=a(195),c=a(6),s=a(9),u=a(2),d=a(196),m=Object(u.createElement)(d.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(u.createElement)(d.Path,{d:"M18.5 15v3.5H13V6.7l4.5 4.1 1-1.1-6.2-5.8-5.8 5.8 1 1.1 4-4v11.7h-6V15H4v5h16v-5z"})),g=a(4),b=a(194),h=a(1),p=a(10),v=a(7),f=a(12),w=a(197),_=Object(u.createElement)(d.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(u.createElement)(d.Path,{d:"M17.5 7v8H19V7c0-1.1-.9-2-2-2H9v1.5h8c.3 0 .5.2.5.5zM7 17.5c-.3 0-.5-.2-.5-.5V1H5v4H1v1.5h4V17c0 1.1.9 2 2 2h10.5v4H19v-4h4v-1.5H7z"}));const E=["image"],O=(e,t)=>t&&!e&&!Object(r.isBlobURL)(t),k=(e,t)=>e.hasOwnProperty("sizes")||e.hasOwnProperty("url")||e.hasOwnProperty("media_details")||e.hasOwnProperty("source_url")||void 0!==e[t],j=e=>{var t,a;return((null===(t=wp)||void 0===t||null===(a=t.media)||void 0===a?void 0:a.attachment(e))||{}).destroyed};function R(e){var t;let{temporaryURL:a,attributes:{url:i="",alt:n,align:l,id:o,width:r,widthTablet:d,widthMobile:m,height:b,heightTablet:v,heightMobile:O},setAttributes:k,isSelected:R,onCloseModal:y,onSelectImage:S,onSelectURL:z,onUploadError:x,containerRef:I,context:L,clientId:M,onImageLoadError:T}=e;const U=Object(u.useRef)(),{allowResize:B=!0}=L,{toggleSelection:C}=Object(s.useDispatch)(g.store),H=Object(p.a)(),{multiImageSelection:N}=Object(s.useSelect)(e=>{const{getMultiSelectedBlockClientIds:t,getBlockName:a}=e(g.store),i=t();return{multiImageSelection:i.length&&i.every(e=>"uagb/image"===a(e))}},[o,R]),{imageEditing:P,maxWidth:W}=Object(s.useSelect)(e=>{const{getSettings:t}=e(g.store),{imageEditing:a,maxWidth:i}=t();return{imageEditing:a,maxWidth:i}},[M]),F=Object(f.useViewportMatch)("medium"),A=["wide","full"].includes(l),[{loadedNaturalWidth:D,loadedNaturalHeight:V},G]=Object(u.useState)({}),[J,q]=Object(u.useState)(!1),K=function(e,t){const[a,i]=Object(u.useState)();function n(){i(e.current.clientWidth)}return Object(u.useEffect)(n,t),Object(u.useEffect)(()=>{const{defaultView:t}=e.current.ownerDocument;return t.addEventListener("resize",n),()=>{t.removeEventListener("resize",n)}},[]),a}(I,[l]),Q=B&&!(A&&F),{naturalWidth:X,naturalHeight:Y}=Object(u.useMemo)(()=>{var e,t;return{naturalWidth:(null===(e=U.current)||void 0===e?void 0:e.naturalWidth)||D||void 0,naturalHeight:(null===(t=U.current)||void 0===t?void 0:t.naturalHeight)||V||void 0}},[D,V,null===(t=U.current)||void 0===t?void 0:t.complete]),Z=Object(w.getFilename)(i);let $;$=n||(Z?Object(h.sprintf)(
/* translators: %s: file name */
Object(h.__)("This image has an empty alt attribute; its file name is %s"),Z):Object(h.__)("This image has an empty alt attribute"));let ee,te,ae=React.createElement(React.Fragment,null,React.createElement("img",{src:a||i,alt:$,onLoad:e=>{var t,a;G({loadedNaturalWidth:null===(t=e.target)||void 0===t?void 0:t.naturalWidth,loadedNaturalHeight:null===(a=e.target)||void 0===a?void 0:a.naturalHeight})},ref:U}),a&&React.createElement(c.Spinner,null));if(K&&X&&Y){const e=X>K,t=Y/X;ee=e?K:X,te=e?K*t:Y}Object(u.useEffect)(()=>{R||q(!1),R&&j(o)&&T()},[R]);const ie=o&&X&&Y&&P,ne=!N&&ie&&!J;if(ie&&J)ae=React.createElement(g.__experimentalImageEditor,{url:i,width:r,height:b,clientWidth:K,naturalHeight:Y,naturalWidth:X});else if(Q&&ee){const e=r||ee,t=b||te,a=X/Y,i=X<Y?20:20*a,n=Y<X?20:20/a,o=2.5*W;let s=!1,u=!1;"center"===l?(s=!0,u=!0):Object(h.isRTL)()?"left"===l?s=!0:u=!0:"right"===l?u=!0:s=!0;let g="",p="";"Tablet"===H?(g=d,p=v):"Mobile"===H?(g=m,p=O):(g=r,p=b),ae=React.createElement(c.ResizableBox,{size:{width:g||"auto",height:p||"auto"},showHandle:R,minWidth:i,maxWidth:o,minHeight:n,maxHeight:o/a,lockAspectRatio:!0,enable:{top:!1,right:s,bottom:!0,left:u},onResizeStart:function(){C(!1)},onResizeStop:(a,i,n,l)=>{C(!0),k("Tablet"===H?{widthTablet:Math.abs(parseInt(d+l.width,10)),heightTablet:Math.abs(parseInt(v+l.height,10))}:"Mobile"===H?{widthMobile:Math.abs(parseInt(m+l.width,10)),heightMobile:Math.abs(parseInt(O+l.height,10))}:{width:Math.abs(parseInt(e+l.width,10)),height:Math.abs(parseInt(t+l.height,10))})}},ae)}else ae=React.createElement("div",{style:{width:r,height:b}},ae);const le=React.createElement(React.Fragment,null,React.createElement(g.BlockControls,{group:"block"},ne&&React.createElement(c.ToolbarButton,{onClick:()=>q(!0),icon:_,label:Object(h.__)("Crop")})),!N&&!J&&React.createElement(g.BlockControls,{group:"other"},React.createElement(g.MediaReplaceFlow,{mediaId:o,mediaURL:i,allowedTypes:E,accept:"image/*",onSelect:S,onSelectURL:z,onError:x,onCloseModal:y})));return React.createElement(React.Fragment,null,React.createElement(g.__experimentalImageEditingProvider,{id:o,url:i,naturalWidth:X,naturalHeight:Y,clientWidth:K,onSaveImage:e=>k(e),isEditing:J,onFinishEditing:()=>q(!1)},!a&&le,ae))}function y(e){let{attributes:t,isSelected:a,setAttributes:l,captionRef:o}=e;const{caption:r,heading:c,headingTag:s,layout:u,overlayContentPosition:d,seperatorStyle:m,seperatorPosition:b}=t,p=Object(i.useRef)();Object(i.useEffect)(()=>{p.current=c},[r]);const v=n.a.createElement(n.a.Fragment,null,(!g.RichText.isEmpty(c)||a)&&n.a.createElement(g.RichText,{ref:p,tagName:s,className:"uagb-image-heading","aria-label":Object(h.__)("Image overlay heading text"),placeholder:Object(h.__)("Add Heading"),value:c,onChange:e=>l({heading:e})})),f=n.a.createElement(n.a.Fragment,null,(!g.RichText.isEmpty(r)||a)&&n.a.createElement(g.RichText,{ref:o,tagName:"figcaption",className:"uagb-image-caption","aria-label":Object(h.__)("Image caption text"),placeholder:Object(h.__)("Add caption"),value:r,onChange:e=>l({caption:e})})),w="none"!==m&&n.a.createElement("div",{className:"uagb-image-separator"});return n.a.createElement(n.a.Fragment,null,"overlay"===u?n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"wp-block-uagb-image--layout-overlay__color-wrapper"}),n.a.createElement("div",{className:"wp-block-uagb-image--layout-overlay__inner "+d.replace(" ","-")},"before_title"===b&&w,v,"after_title"===b&&w,f,"after_sub_title"===b&&w)):f)}var S,z=a(13),x=a.n(z),I=a(317),L=0,M={injectType:"lazySingletonStyleTag",attributes:{id:"uagb-editor-styles"},insert:"head",singleton:!0},T={};T.locals=I.a.locals||{},T.use=function(){return L++||(S=x()(I.a,M)),T},T.unuse=function(){L>0&&!--L&&(S(),S=null)};var U=T;function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}const C=e=>{const{attributes:t,setAttributes:a,className:l,isSelected:u,insertBlocksAfter:d,onReplace:f,context:w,clientId:_}=e.parentProps,{block_id:S,isPreview:z,layout:x,url:I,alt:L,sizeSlug:M,caption:T,align:C,id:H,linkTarget:N,linkClass:P,rel:W,imageHoverEffect:F,href:A,linkDestination:D}=t;Object(i.useLayoutEffect)(()=>(U.use(),()=>{U.unuse()}),[]);const V=Object(p.a)(),{createNotice:G}=Object(s.useDispatch)("core/notices"),[J,q]=Object(i.useState)(),[K,Q]=Object(i.useState)(),X=Object(i.useRef)();Object(i.useEffect)(()=>{X.current=L},[L]);const Y=Object(i.useRef)();Object(i.useEffect)(()=>{Y.current=T},[T]);const Z=Object(i.useRef)(),{imageDefaultSize:$,mediaUpload:ee}=Object(s.useSelect)(e=>{const{getSettings:t}=e(g.store),{imageDefaultSize:a,mediaUpload:i}=t();return{imageDefaultSize:a,mediaUpload:i}},[]),{image:te}=Object(s.useSelect)(e=>{const{getMedia:t}=e(b.store);return{image:H&&u?t(H):null}},[H,u]);function ae(){j(null==t?void 0:t.id)&&a({url:void 0,id:void 0})}function ie(e){G("error",e,{type:"snackbar"})}function ne(e){var i,n,l,o,c;if(!e||!e.url)return void a({url:void 0,alt:void 0,id:void 0,title:void 0,caption:void 0});if(Object(r.isBlobURL)(e.url))return void q(e.url);q();let s,u=((e,t)=>{var a;const{alt:i,id:n,link:l,caption:o,url:r}=e,c={alt:i,id:n,link:l,caption:o,url:r};var s,u,d,m,g,b,h,p,v;return null!=e&&e.sizes&&null!=e&&e.sizes[t]?{...c,width:null==e||null===(s=e.sizes[t])||void 0===s?void 0:s.width,height:null==e||null===(u=e.sizes[t])||void 0===u?void 0:u.height,url:null==e||null===(d=e.sizes[t])||void 0===d?void 0:d.url}:null!=e&&e.media_details&&null!=e&&null!==(a=e.media_details)&&void 0!==a&&a.sizes[t]?{...c,width:null==e||null===(m=e.media_details)||void 0===m||null===(g=m.sizes[t])||void 0===g?void 0:g.width,height:null==e||null===(b=e.media_details)||void 0===b||null===(h=b.sizes[t])||void 0===h?void 0:h.height,url:null==e||null===(p=e.media_details)||void 0===p||null===(v=p.sizes[t])||void 0===v?void 0:v.source_url}:{...c,url:null==e?void 0:e.url}})(e,$);Y.current&&!u.caption&&(u={...u,alt:u.alt,id:u.id,link:u.link}),s=e.id&&e.id===H?{url:I}:{width:void 0,height:void 0,sizeSlug:k(e,$)?$:"full"};let d,m=t.linkDestination;if(!m)switch((null===(i=wp)||void 0===i||null===(n=i.media)||void 0===n||null===(l=n.view)||void 0===l||null===(o=l.settings)||void 0===o||null===(c=o.defaultProps)||void 0===c?void 0:c.link)||"none"){case"file":case"media":m="media";break;case"post":case"attachment":m="attachment";break;case"custom":m="custom";break;case"none":m="none"}switch(m){case"media":d=e.url;break;case"attachment":d=e.link}u.href=d,a({...u,...s,linkDestination:m})}function le(e){e!==I&&a({url:e,id:void 0,width:void 0,height:void 0,sizeSlug:$})}let oe=((e,t)=>!e&&Object(r.isBlobURL)(t))(H,I);Object(i.useEffect)(()=>{if(!oe)return;const e=Object(r.getBlobByURL)(I);e&&ee({filesList:[e],onFileChange:e=>{let[t]=e;ne(t)},allowedTypes:E,onError:e=>{oe=!1,G("error",e,{type:"snackbar"}),a({src:void 0,id:void 0,url:void 0})}})},[]),Object(i.useEffect)(()=>{oe?q(I):Object(r.revokeBlobURL)(J)},[oe,I]);const re=O(H,I)?I:void 0,ce=!!I&&n.a.createElement("img",{alt:Object(h.__)("Edit image"),title:Object(h.__)("Edit image"),className:"edit-image-preview",src:I});Object(i.useEffect)(()=>{O(H,I)&&u&&!K&&window.fetch(I).then(e=>e.blob()).then(e=>Q(e)).catch(()=>{})},[H,I,u,K]);const se=uagb_blocks_info.uagb_url+"/admin/assets/preview-images/image.svg",ue=Object(g.useBlockProps)({ref:Z});return n.a.createElement(n.a.Fragment,null,n.a.createElement(g.BlockControls,{group:"block"},n.a.createElement(g.BlockAlignmentControl,{value:C,onChange:function(e){const t=["wide","full"].includes(e)?{width:void 0,height:void 0}:{};a({...t,align:e})}}),n.a.createElement(g.__experimentalImageURLInputUI,{url:A||"",onChangeUrl:function(e){a(e)},linkDestination:D,mediaUrl:te&&te.source_url||I,mediaLink:te&&te.link,linkTarget:N,linkClass:P,rel:W}),K&&n.a.createElement(c.ToolbarButton,{onClick:function(){ee({filesList:[K],onFileChange(e){let[t]=e;ne(t),Object(r.isBlobURL)(null==t?void 0:t.url)||(Q(),G("success",Object(h.__)("Image uploaded."),{type:"snackbar"}))},allowedTypes:E,onError(e){G("error",e,{type:"snackbar"})}})},icon:m,label:Object(h.__)("Upload external image")})),n.a.createElement("div",B({},ue,{className:o()(l,"uagb-editor-preview-mode-"+V.toLowerCase(),"uagb-block-"+S,"wp-block-uagb-image--layout-"+x,"wp-block-uagb-image--effect-"+F,"wp-block-uagb-image--align-"+(C||"none"))}),(J||I)&&n.a.createElement("figure",{className:"wp-block-uagb-image__figure"},n.a.createElement(R,{temporaryURL:J,attributes:t,setAttributes:a,isSelected:u,insertBlocksAfter:d,onReplace:f,onSelectImage:ne,onSelectURL:le,onUploadError:ie,containerRef:Z,context:w,clientId:_,onCloseModal:ae,onImageLoadError:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e||a({url:void 0,id:void 0})}}),n.a.createElement(y,{captionRef:Y,attributes:t,setAttributes:a,isSelected:u})),z?n.a.createElement("img",{width:"100%",src:se,alt:""}):n.a.createElement(g.MediaPlaceholder,{icon:n.a.createElement(g.BlockIcon,{icon:v.a.image}),labels:{title:Object(h.__)("Advanced Image","ultimate-addons-for-gutenberg"),instructions:Object(h.__)("Upload an image file, pick one from your media library, or add one with a URL.","ultimate-addons-for-gutenberg")},onSelect:ne,onSelectURL:le,onError:ie,onClose:ae,accept:"image/*",allowedTypes:E,value:{id:H,src:re},mediaPreview:ce,disableMediaButtons:J||I})))};C.propTypes={},C.defaultProps={},t.default=n.a.memo(C)}}]);